<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><head><style><!--

					/*paged media */ div.header {display: none }
					div.footer {display: none } /*@media print { */
					
						div.header {display: block; position: running(header) }
					
						div.footer {display: block; position: running(footer) }
					

					@page { size: A4; margin: 10%; @top-center {
					content: element(header) } @bottom-center {
					content: element(footer) } }


					/*font definitions*/

					/*element styles*/ .del
					{text-decoration:line-through;color:red;}
					
						  .ins {text-decoration:none;background:#c0ffc0;padding:1px;}
						


					/* Word style definitions */
					
 /* TABLE STYLES */ 
.TableNormal {display:table;position: relative; margin-left: 0in;}
.TableGrid {display:table;position: relative; margin-left: 0in;border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;space-after: 0in;line-height: 100%;}

 /* PARAGRAPH STYLES */ 
.DocDefaults {display:block;space-after: 4mm;line-height: 115%;font-family: Calibri;font-size: 11.0pt;}
.Normal {display:block;}
.NormalWeb {display:block;space-before: 0.07in;space-after: 0.07in;line-height: 100%;font-family: Times New Roman;font-size: 12.0pt;}
.Command {display:block;position: relative; margin-left: 0.5in;font-family: Consolas;font-size: 10.0pt;}
.Heading1 {display:block;page-break-after: avoid;space-before: 0.33in;space-after: 4mm;font-weight: bold;color: #365F91;font-family: Calibri;font-size: 18.0pt;}
.Footer {display:block;space-after: 0in;line-height: 100%;}
.FootnoteText {display:block;space-after: 0in;line-height: 100%;font-size: 10.0pt;}
.Header {display:block;space-after: 0in;line-height: 100%;}
.Heading2 {display:block;space-before: 0.07in;space-after: 0.07in;line-height: 100%;font-weight: bold;font-style: italic;font-family: Calibri;font-size: 14.0pt;}
.h3 {display:block;font-style: normal;font-size: 11.0pt;text-decoration: none;}
.listparagraph0 {display:block;space-before: 0.07in;space-after: 0.07in;line-height: 100%;font-family: Times New Roman;font-size: 12.0pt;}
.Title {display:block;border-bottom-style: solid;border-bottom-width: 0.35mm;border-bottom-color: #4F81BD;space-after: 0.21in;line-height: 100%;color: #17365D;font-family: Calibri;font-size: 26.0pt;}
.normal0 {display:block;space-before: 0.07in;space-after: 0.07in;line-height: 100%;font-family: Times New Roman;font-size: 12.0pt;}
.ListParagraph {display:block;position: relative; margin-left: 0.5in;}

 /* CHARACTER STYLES */ .DefaultParagraphFont {display:inline;}
.FootnoteReference {display:inline;vertical-align: top;font-size: xx-small;}
.apple-style-span {display:inline;}
.xmlmarkupattributename {display:inline;}
.Strong {display:inline;font-weight: bold;}
.xmlmarkuptagname {display:inline;}
.Emphasis {display:inline;font-style: italic;}
.xmlmarkupattributevalue {display:inline;}
.underline {display:inline;}
.Hyperlink {display:inline;color: #0000FF;text-decoration: none;}
.HTMLCode {display:inline;font-family: Courier New;font-size: 10.0pt;}
.icon {display:inline;}
.apple-converted-space {display:inline;}
.xmlmarkupbracket {display:inline;}


					/* TABLE CELL STYLES */
					#docx4j_tbl_0 td { border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;height: 5mm;}
#docx4j_tbl_1 td { border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;height: 5mm;}
#docx4j_tbl_2 td { border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;height: 5mm;}
#docx4j_tbl_3 td { border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;height: 5mm;}
#docx4j_tbl_4 td { border-top-style: solid;border-top-width: 1px;border-top-color: #000000;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;height: 5mm;}
--></style><script type="text/javascript">
				
				function toggleDiv(divid){
					if(document.getElementById(divid).style.display == 'none'){
						document.getElementById(divid).style.display = 'block';
					}else{
						document.getElementById(divid).style.display = 'none';
					}
				}
								
			</script></head><body>
  
  <div class="header">
  
  <p class="Header Normal DocDefaults " /></div>
  
  <div class="document">
  
  <p class="Title Normal DocDefaults ">Docx4j - Getting Started</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">This guide is for docx4j </span><span style="font-weight: bold;">2.7.1</span>.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">The latest version of this document can always be found in </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j/docs/"><span class="Hyperlink DefaultParagraphFont ">docx4j svn in /docs</span></a><span style="white-space:pre-wrap;"> (in Flat OPC XML format for Word 2007, </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j/docs/Docx4j_GettingStarted.html"><span class="Hyperlink DefaultParagraphFont ">HTML</span></a><span style="white-space:pre-wrap;">, and </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j/docs/Docx4j_GettingStarted.pdf"><span class="Hyperlink DefaultParagraphFont ">PDF</span></a>).</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">The most up to date copy of this document is in English.  From time to time, it is machine translated into other languages.  </span></p>
  
  <p class="Heading1 Normal DocDefaults ">What is docx4j?</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">docx4j is a library for unzipping a docx "package", and parsing the WordprocessingML XML to create an in-memory representation in </span><span style="font-weight: bold;">Java</span>.  Recent versions of docx4j also support Powerpoint pptx files and Excel xlsx files.</p>
  
  <p class="Normal DocDefaults ">It is similar in concept to Microsoft's  OpenXML SDK, which is for .NET.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">docx4j is open source, available under the Apache License (v2).  As an open source project, contributions are welcome.  Please see the docx4j forum at </span><a href="http://dev.plutext.org/forums/"><span style="color: #0000FF;text-decoration: none;">http://dev.plutext.org/forums/</span></a><span style="white-space:pre-wrap;"> for details.</span></p><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;">
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-family: Calibri;text-decoration: none;">The Docx4j social contract</span></p>
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">docx4j is currently available under the Apache Software license.  This gives you freedom to do pretty much anything you like with it.  It also means you don't have to pay for it (there is no incentive to take up a commercial license, so we don't offer one).</span></p>
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">The </span></span><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-style: italic;font-family: Calibri;">quid pro quo</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;"> is that if docx4j helps you out, you should </span></span><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-style: italic;font-family: Calibri;">please</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;"> "give something back", by way of code, community support, by "spreading the word" (promotion), or by buying commerical support. Your choice.  docx4j needs you help to make it easier for people to find it. </span></span></p>
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">If you choose promotion, your options include:</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">emailing to jharrop@plutext.com a</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;"> testimonial which we can put on our </span></span><span style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">website (preferably with your organization name, but without is worthwhile as well), </span></span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">a </span></span>blog<span style="color: #000000;font-family: Calibri;"> post, a tweet</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">, or a helpful (non-spammy) comment in an online forum,</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">sharing the content on our blog, following jasonharrop on Twitter, or connecting on LinkedIn.</span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.03in;border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">Your promotion/support will help grow the docx4j community and thus its strength, to the benefit of all. </span></span></p>
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">Please complete our very short new user survey at </span></span><a href="http://www.plutext.com/limesurvey/index.php?sid=78372&amp;lang=en"><span class="Hyperlink DefaultParagraphFont " style="color: #819D26;font-family: Calibri;font-size: 8.0pt;">http://www.plutext.com/limesurvey/index.php?sid=78372</span></a><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">. It includes a question on the above.  Thanks.</span></p></div></div>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Docx4j relies heavily on </span><span style="font-weight: bold;">JAXB</span>, the JCP standard for Java - XML binding.  You can think of docx4j as a JAXB implementation of (amongst others):</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Open Packaging Conventions</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>WordProcessingML (docx) part of Open XML</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">Presentation ML (pptx) part of OpenXML </span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>SpreadsheetML (xlsx) part of Open XML.</p>
  
  <p class="Normal DocDefaults ">The library is designed to round trip docx files with 100% fidelity, and supports all 2007 WordML.  Support for new Word 2010 features will be added soon.</p>
  
  <p class="Normal DocDefaults ">The docx4j project is sponsored by Plutext (<a href="http://www.plutext.com"><span class="Hyperlink DefaultParagraphFont ">www.plutext.com</span></a>).</p>
  
  <p class="Heading1 Normal DocDefaults ">Is docx4j for you?</p>
  
  <p class="Normal DocDefaults ">Docx4j is for processing docx documents (and pptx presentations and xlsx spreadsheets) in Java.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">It isn't for old binary (.doc) files.  If you wish to invest your effort around docx (as is wise), but you also need to be able to handle old doc files, see further below for your options. </span></p>
  
  <p class="Normal DocDefaults ">Nor is it for RTF files.</p>
  
  <p class="Normal DocDefaults ">If you want to process docx documents on the .NET platform, you should look at Microsoft's  OpenXML SDK instead.</p>
  
  <p class="Normal DocDefaults ">An alternative to docx4j is Apache POI.  I'd particularly recommend that if you are only processing Excel documents, and need support for the old binary xls format.  Since POI uses XmlBeans (not JAXB) it may be a better choice if you want to use XmlBeans.</p>
  
  <p class="Heading1 Normal DocDefaults ">What sorts of things can you do with docx4j?</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Open existing docx (from filesystem, SMB/CIFS, WebDAV using VFS), pptx, xlsx</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Create new docx, pptx, xlsx</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Programmatically manipulate the above (of course)</p>
  
  <p class="Normal DocDefaults ">Specific to docx4j (as opposed to pptx4j, xlsx4j):</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Template substitution; CustomXML binding</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Produce/consume Word 2007's xmlPackage (pkg) format</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Save docx to filesystem as a docx (ie zipped), or to JCR (unzipped)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Apply transforms, including common filters</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Export as HTML or PDF</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Diff/compare documents, paragraphs or sdt (content controls)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Font support (font substitution, and use of any fonts embedded in the document)</p>
  
  <p class="Normal DocDefaults ">This document focuses primarily on docx4j, but the general principles are equally applicable to pptx4j and xlsx4j.</p><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;">
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-style: italic;font-family: Calibri;"><span style="white-space:pre-wrap;">docx4all </span></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;"> is an example of an application based on docx4j; its a Swing-based wordprocessor for docx documents.  You can try it or download its source code at </span></span><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-family: Calibri;">dev.plutext.org</span></p></div></div>
  
  <p class="Normal DocDefaults " />
  
  <p class="Heading1 Normal DocDefaults ">What Word documents does it support?</p>
  
  <p class="Normal DocDefaults ">Docx4j can read/write docx documents created by or for Word 2007, or earlier versions which have the compatibility pack installed.</p>
  
  <p class="Normal DocDefaults ">The relevant parts of docx4j are generated from the ECMA schemas.</p>
  
  <p class="Normal DocDefaults ">It can't read/write Word 2003 XML documents.  The main problem with those is that the XML namespace is different.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Docx4j </span>2.7.1 handles<span style="white-space:pre-wrap;"> Word 2010 </span>specific features, by gracefully degrading to the specified<span style="white-space:pre-wrap;"> 2007 </span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">For more information, please see </span><span style="white-space:pre-wrap;"> below.</span></p>
  
  <p class="Heading1 Normal DocDefaults ">Handling legacy binary .doc files</p>
  
  <p class="Normal DocDefaults ">Apache POI's HWPF can read .doc files, and docx4j could use this for basic conversion of .doc to .docx.  The problem with this approach is that POI's HWPF code fails on many .doc files.</p>
  
  <p class="Normal DocDefaults ">An effective approach is to use OpenOffice (via jodconverter) to convert the doc to docx, which docx4j can then process.  If you need to return a binary .doc, OpenOffice/jodconverter can convert the docx back to .doc.</p>
  
  <p class="Normal DocDefaults ">There is also http://b2xtranslator.sourceforge.net/ .  If a pure Java approach were required, this could be converted.</p>
  
  <p class="Heading1 Normal DocDefaults ">Using docx4j binaries</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">You can download the latest version of docx4j from </span><a href="http://dev.plutext.org/docx4j/"><span class="Hyperlink DefaultParagraphFont ">http://dev.plutext.org/docx4j/</span></a></p>
  
  <p class="Normal DocDefaults ">In general, we suggest you develop against a currently nightly build, since the latest formal release can often be several months old.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Supporting jars can be found in the .tar.gz version, or in the relevant subdirectory.  </span></p>
  
  <p class="Heading1 Normal DocDefaults ">Command Line Samples</p>
  
  <p class="Normal DocDefaults ">With docx4j version 2.6.0, there are several samples you can run right away from the command line.</p>
  
  <p class="Normal DocDefaults ">The two to try (both discussed in detail further below) are:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>OpenMainDocumentAndTraverse</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>PartsList</p>
  
  <p class="Normal DocDefaults ">Invoke with a command like:</p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Courier New;font-size: 6.5pt;">   java -cp docx4j.jar:log4j-1.2.15.jar org.docx4j.samples.OpenMainDocumentAndTraverse [input.docx]</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">If there are any images in the docx, you'd also need:</span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">   xmlgraphics-commons-1.4.jar</span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">   commons-logging-1.1.1.jar</span></p>
  
  <p class="Normal DocDefaults ">on your classpath.</p>
  
  <p class="Heading1 Normal DocDefaults ">docx4j dependencies</p>
  
  <p class="Heading2 Normal DocDefaults ">log4j</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">To do anything with docx4j, you need </span><span style="font-weight: bold;">log4j</span><span style="white-space:pre-wrap;"> on your classpath.</span></p>
  
  <p class="Normal DocDefaults "><span class="underline DefaultParagraphFont "><span style="white-space:pre-wrap;">To actually enable logging, you need a log4.properties or log4j.xml on your class path.  See for example </span></span><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/resources/log4j.xml"><span style="color: #0000FF;text-decoration: none;">http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/resources/log4j.xml</span></a><span style="white-space:pre-wrap;">  </span>If you don't<span style="white-space:pre-wrap;"> configure log4j like that</span>, docx4j will auto configure logging at INFO level.</p>
  
  <p class="Normal DocDefaults ">If you are using Eclipse to run things, in the run configuration:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">add VM argument </span><br clear="all" /><br clear="all" />   -Dlog4j.configuration=log4j.xml<br clear="all" /></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>to the classpath, add a user entry (click "advanced..") for<br clear="all" /><br clear="all" />   src/main/resources</p>
  
  <p class="Heading2 Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;">images</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">If there are any images in the docx, you'll also need:</span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">   xmlgraphics-commons-1.4.jar</span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">   which in turn requires commons-logging-1.1.1.jar</span></p>
  
  <p class="Heading2 Normal DocDefaults "><span style="white-space:pre-wrap;">other dependencies </span></p>
  
  <p class="Normal DocDefaults ">Depending what you want to do, the other dependencies will be required. The following table explains the other dependencies:</p>
  
  <table class="TableGrid TableNormal " id="docx4j_tbl_0" style="table-layout: fixed;border-collapse: collapse;"><colgroup><col style="width: 56mm;" /><col style="width: 56mm;" /><col style="width: 56mm;" /></colgroup><tbody><tr style="vertical-align: top;"><td style="background-color: #DDD9C3;">
  
  <p class="Normal DocDefaults ">Functionality</p></td><td style="background-color: #DDD9C3;">
  
  <p class="Normal DocDefaults ">Jar</p></td><td style="background-color: #DDD9C3;">
  
  <p class="Normal DocDefaults ">which also requires</p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults ">HTML export</p></td><td>
  
  <p class="Normal DocDefaults ">Xalan</p></td><td>
  
  <p class="Normal DocDefaults " /></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults ">PDF export</p></td><td>
  
  <p class="Normal DocDefaults ">Xalan,<br clear="all" />FOP</p></td><td>
  
  <p class="Normal DocDefaults ">commons-io</p>
  
  <p class="Normal DocDefaults ">avalon-framework api &amp; impl</p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults ">OLE, binary import</p></td><td>
  
  <p class="Normal DocDefaults ">POI, commons-codec</p></td><td>
  
  <p class="Normal DocDefaults " /></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults ">Differencing</p></td><td>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">commons-lang, </span><br clear="all" />stax (for Java 1.5 only)</p></td><td>
  
  <p class="Normal DocDefaults " /></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults " /></td><td>
  
  <p class="Normal DocDefaults ">wmf2svg</p></td><td>
  
  <p class="Normal DocDefaults " /></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults ">Saving/loading via WebDAV etc</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">External graphics </span><br clear="all" /></p></td><td>
  
  <p class="Normal DocDefaults ">commons-vfs</p></td><td>
  
  <p class="Normal DocDefaults ">jdom</p></td></tr></tbody></table>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">As noted above, docx4j dependencies (with the exception of stax) can be found in the .tar.gz version, or in the relevant subdirectory of  </span><a href="http://dev.plutext.org/docx4j/"><span class="Hyperlink DefaultParagraphFont ">http://dev.plutext.org/docx4j/</span></a></p>
  
  <p class="Normal DocDefaults ">You can also get them via Maven (see next section).</p>
  
  <p class="Heading1 Normal DocDefaults ">Using docx4j via Maven</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Maven POM can be found at </span><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/m2/org/docx4j/docx4j"><span class="Hyperlink DefaultParagraphFont ">http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/m2/org/docx4j/docx4j</span></a></p>
  
  <p class="Normal DocDefaults ">As from version 2.7.1, docx4j is in Maven Central.</p>
  
  <p class="Heading1 Normal DocDefaults ">JDK versions</p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont ">You need to be using Java 1.5+.</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont ">This is because of JAXB</span><span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fs1"><a href="#fn1">1</a></a></span></span><span class="apple-style-span DefaultParagraphFont ">.  If you must use  1.4, retrotranslator can</span><span class="apple-converted-space DefaultParagraphFont "><span style="white-space:pre-wrap;"> </span></span><a href="http://forums.java.net/jive/message.jspa?messageID=212494"><span class="icon DefaultParagraphFont ">reportedly make</span></a><span class="apple-style-span DefaultParagraphFont "><span style="white-space:pre-wrap;"> it work.</span></span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont ">If you are using 1.5 only, and want to do differencing, you will need stax (uncomment it in pom.xml).</span></p>
  
  <p class="Heading1 Normal DocDefaults ">A word about Jaxb</p>
  
  <p class="Normal DocDefaults ">docx4j uses JAXB to marshall and unmarshall the key parts in a WordprocessingML document, including the main document part, the styles part, the theme part, and the properties parts.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">JAXB is included in Sun's Java 6 distributions, but not 1.5.  So if you are using the 1.5 JDK, you will need JAXB 2.1.x on your class path.  </span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Bits of docx4j, such as </span><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/wml"><span class="Hyperlink DefaultParagraphFont ">org.docx4j.wml</span></a><span style="white-space:pre-wrap;"> and </span><span class="apple-converted-space DefaultParagraphFont " style="font-family: Calibri;"> </span><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/dml"><span class="Hyperlink DefaultParagraphFont ">org.docx4j.dml</span></a><span style="white-space:pre-wrap;"> were generated using JAXB's XJC. We modified the wml.xsd schema in particular, so that the key resulting classes are a bit more human friendly (ie don't all start with CT_ and ST_). </span></p>
  
  <p class="Heading1 Normal DocDefaults ">Javadoc</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Javadoc for browsing online or download, can be found in the directory </span><a href="http://dev.plutext.org/docx4j/"><span style="color: #0000FF;text-decoration: none;">http://dev.plutext.org/docx4j/</span></a></p>
  
  <p class="Heading1 Normal DocDefaults ">Docx4j source code</p>
  
  <p class="Normal DocDefaults ">To obtain a copy of the current source code:</p>
  
  <p class="NormalWeb Normal DocDefaults ">   <span style="font-family: Consolas;font-size: 10.0pt;">svn co</span><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j"><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">http://dev.plutext.org/svn/docx4j/trunk/docx4j</span></a><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><span style="font-family: Consolas;font-size: 10.0pt;">docx4j</span></p>
  
  <p class="Normal DocDefaults ">Alternatively, you can browse it online, at:</p>
  
  <p class="Normal DocDefaults ">http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="white-space:pre-wrap;">Building docx4j from source </span></p>
  
  <p class="Normal DocDefaults ">To obtain a copy of the current source code:</p>
  
  <p class="NormalWeb Normal DocDefaults ">   <span style="font-family: Consolas;font-size: 10.0pt;">svn co</span><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j"><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">http://</span><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">www.docx4java</span><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">.org/svn/docx4j/trunk/docx4j</span></a><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><span style="font-family: Consolas;font-size: 10.0pt;">docx4j</span></p>
  
  <p class="Normal DocDefaults ">Alternatively, you can browse it online, at:</p>
  
  <p class="Normal DocDefaults ">http://<span style="white-space:pre-wrap;"> www.docx4java</span>.org/trac/docx4j/browser/trunk/docx4j/</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="white-space:pre-wrap;">Building docx4j from source </span></p>
  
  <p class="Heading2 Normal DocDefaults ">Command line -via Maven</p>
  
  <p class="Normal DocDefaults ">Create a directory called workspace, and cd into it.</p>
  
  <p class="NormalWeb Normal DocDefaults ">   <span style="font-family: Consolas;font-size: 10.0pt;">svn co</span><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j"><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">http://</span><span style="white-space:pre-wrap;"> </span><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">www.docx4java</span><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">.org/svn/docx4j/trunk/docx4j</span></a><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><span style="font-family: Consolas;font-size: 10.0pt;">docx4j</span></p>
  
  <p class="Command NormalWeb Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">export MAVEN_OPTS=-Xmx512m</span><span style="color: #000000;font-family: Calibri;"><br clear="all" /></span><span style="white-space:pre-wrap;">mvn install </span></p>
  
  <p class="Heading2 Normal DocDefaults ">Command line - via Ant</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Before you can build via ant, you need to obtain docx4j's </span>dependencies<span style="white-space:pre-wrap;">.  You can get them from the binary distribution, or via maven.  </span></p>
  
  <p class="Normal DocDefaults ">Once you have done that<span style="white-space:pre-wrap;">, create a </span>directory called workspace, and cd into it.</p>
  
  <p class="NormalWeb Normal DocDefaults ">   <span style="font-family: Consolas;font-size: 10.0pt;">svn co</span><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j"><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">http://</span><span style="white-space:pre-wrap;"> </span><span class="icon DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">www.docx4java.org/svn/docx4j/trunk/docx4j</span></a><span class="apple-converted-space DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;"> </span><span style="font-family: Consolas;font-size: 10.0pt;">docx4j</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Edit build.xml, so the pathelements point to where you placed </span>the dependencies.</p>
  
  <p class="Normal DocDefaults ">Then</p>
  
  <p class="NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="font-family: Consolas;font-size: 10.0pt;">ant dist</span></p>
  
  <p class="Normal DocDefaults ">or on Linux</p>
  
  <p class="NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="font-family: Consolas;font-size: 10.0pt;">ANT_OPTS="-Xmx512m -XX:MaxPermSize=256m" ant dist</span></p>
  
  <p class="Normal DocDefaults ">That ant command will create the docx4j.jar and place it and all its dependencies in the dist dir.</p>
  
  <p class="Heading2 Normal DocDefaults ">Eclipse</p>
  
  <p class="h3 Heading2 Normal DocDefaults ">Prerequisites</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Eclipse installed</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Install an Eclipse subversion plugin eg<span class="apple-converted-space DefaultParagraphFont "> </span><a href="http://subclipse.tigris.org/update_1.2.x"><span class="icon DefaultParagraphFont ">http://subclipse.tigris.org/update_1.2.x</span></a></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Install<span class="apple-converted-space DefaultParagraphFont "> </span><a href="http://dev.plutext.org/trac/docx4j/trac/umbrella/wiki/MavenEclipse"><span class="Hyperlink DefaultParagraphFont " style="font-family: Calibri;">Maven and the Eclipse plugin</span></a></p>
  
  <p class="Normal DocDefaults ">And, as discussed above:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Java 1.5 or 6</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">JAXB: </span><span style="font-weight: bold;">either</span><span style="white-space:pre-wrap;"> the JAXB implementation included in Java 6, </span><span style="font-weight: bold;">or</span><span style="white-space:pre-wrap;"> the 2.x reference implementation. </span></p>
  
  <p class="h3 Heading2 Normal DocDefaults ">Instructions</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>File &gt; New "Project .." &gt; SVN &gt; Checkout Projects from SVN</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Create a new repository location; Url is<span class="apple-converted-space DefaultParagraphFont "> </span><a href="http://dev.plutext.org/svn/docx4j"><span class="icon DefaultParagraphFont ">http://dev.plutext.org/svn/docx4j</span></a></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Click folder "trunk", and select docx4j; click next</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>You want to check it out as a project configured using the New Project Wizard</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Then select Java &gt; Java Project; click Next</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Choose a project name (eg docx4j) then click Next</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Click Finish (we'll define the Java build settings in a later step)</p>
  
  <p class="Normal DocDefaults ">After a couple of other dialog boxes, you should have the new project in your workspace.</p>
  
  <p class="Normal DocDefaults ">Enable<span style="white-space:pre-wrap;"> Maven </span>(make<span style="white-space:pre-wrap;"> sure you have Maven and its plugin installed - see Prerequisites above</span>):</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>with Eclipse Indigo</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>Right click on the project</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>Click "Configure &gt; Convert to Maven Project"</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>with earlier versions of Eclipse</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>Run mvn install in the docx4j dir from a command prompt (just in case)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>Right click on project &gt; Maven 2 &gt; EnableDependency Management</p>
  
  <p class="Normal DocDefaults ">Set compiler version &amp; system library:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Right click on the<span style="white-space:pre-wrap;"> project </span>(or Alt-Enter)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Choose "Java Compiler", then set JDK<span style="white-space:pre-wrap;"> compliance to 1.6</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Choose "Java Build Path", and check you are using 1.6 "JRE System Library". If not, remove, then click "Add Library"</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Now, we need to check the </span><span style="font-weight: bold;">class path</span><span style="white-space:pre-wrap;"> etc within Eclipse so that it can build.</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Build Path &gt; Configure Build Path &gt; Java Build Path &gt; Source tab</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Verify it contains:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/diffx</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/glox4j</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/main/java</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/pptx4j/java (remove "Excluded: **" if present!)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/svg</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/xslx4j/java</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>src/xslfo</p>
  
  <p class="Normal DocDefaults ">The project should now be working in Eclipse without errors<span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fs2"><a href="#fn2">2</a></a></span></span><span style="white-space:pre-wrap;">. </span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Open an existing docx/pptx/xlsx document</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/openpackaging/packages/WordprocessingMLPackage.java"><span style="font-family: Consolas;">org.docx4j.openpackaging.packages.</span><span style="font-weight: bold;font-family: Consolas;">WordprocessingMLPackage</span></a> represents a docx document.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">To load a document, all you have to do is:</p>
  
  <p class="Command NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0in;">   <span style="white-space:pre-wrap;">WordprocessingMLPackage wordMLPackage = </span><br clear="all" />      WordprocessingMLPackage.load(new java.io.File(inputfilepath));</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">That method can also load “Flat OPC” XML files.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">You can then get the main document part (word/document.xml):</p>
  
  <p class="Command NormalWeb Normal DocDefaults "><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/openpackaging/parts/WordprocessingML/MainDocumentPart.java"><span style="font-family: Calibri;">MainDocumentPart</span></a> documentPart = wordMLPackage.getMainDocumentPart();</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">After that, you can manipulate its contents. </span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">WordprocessingMLPackage.load uses </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">LoadFromZipNG loader = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> LoadFromZipNG();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">If you need to load a docx from an input stream, you can do something like:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   WordprocessingMLPackage pkg = (WordprocessingMLPackage)loader.get(stream);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">A similar approach works for pptx files:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">PresentationMLPackage presentationMLPackage = </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   (PresentationMLPackage)OpcPackage.</span><span style="color: #000000;font-style: italic;font-family: Consolas;font-size: 8.0pt;">load</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">(</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> java.io.File(inputfilepath));</span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">And similarly for xlsx files.</p>
  
  <p class="Heading1 Normal DocDefaults ">WordML concepts</p>
  
  <p class="Normal DocDefaults ">To do anything much beyond this, you need to have an understanding of basic WordML concepts.</p>
  
  <p class="Normal DocDefaults ">According to the Microsoft Open Packaging spec, each docx document is made up of a number of “Part” files, zipped up.  A Part is usually XML, but might not be (an image part, for example, isn't).</p>
  
  <p class="Normal DocDefaults ">The parts form a tree. If a part has child parts, it must have a relationships part which identifies these.</p>
  
  <p class="Normal DocDefaults ">The part which contains the main text of the document is the Main Document Part.  Each Part has a name.  The name of the Main Document Part is usually "/word/document.xml".</p>
  
  <p class="Normal DocDefaults ">If the document has a header, then the main document part woud have a header child part, and this would be described in the main document part's relationships (part).</p>
  
  <p class="Normal DocDefaults ">Similarly for any images.  To see the structure of any given document, see "Parts List" further below.</p>
  
  <p class="Normal DocDefaults ">An introduction to WordML is beyond the scope of this document.  You can find a very readable introduction in 1<span style="vertical-align: top;font-size: xx-small;">st</span><span style="white-space:pre-wrap;"> edition Part 3 (Primer) at </span><a href="http://www.ecma-international.org/publications/standards/Ecma-376.htm"><span style="color: #0000FF;text-decoration: none;">http://www.ecma-international.org/publications/standards/Ecma-376.htm</span></a><span style="white-space:pre-wrap;"> or </span><a href="http://www.ecma-international.org/news/TC45_current_work/TC45_available_docs.htm"><span style="color: #0000FF;text-decoration: none;">http://www.ecma-international.org/news/TC45_current_work/TC45_available_docs.htm</span></a><span style="white-space:pre-wrap;"> (a better link for the 1st edition (Dec 2006), since its not zipped up). </span></p>
  
  <p class="Heading1 Normal DocDefaults "><a name="_Ref280708892" /><span style="font-family: Calibri;">Specification versions</span><span style="font-family: Calibri;"><span style="white-space:pre-wrap;"> </span></span></p>
  
  <p class="Normal DocDefaults ">From Wikipedia:</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">The</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><a href="http://en.wikipedia.org/wiki/Office_Open_XML"><span class="Hyperlink DefaultParagraphFont " style="color: #0645AD;font-family: Arial;font-size: 8.0pt;">Office Open XML</span></a><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"><span style="white-space:pre-wrap;">file formats were standardised between December 2006 and November 2008, </span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">first by the</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><a href="http://en.wikipedia.org/wiki/Ecma_International"><span class="Hyperlink DefaultParagraphFont " style="color: #0645AD;font-family: Arial;font-size: 8.0pt;">Ecma International</span></a><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">consortium (where they became</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-family: Arial;font-size: 8.0pt;">ECMA-376</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"><span style="white-space:pre-wrap;">), </span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">and subsequently .. by the</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><a href="http://en.wikipedia.org/wiki/International_Organization_for_Standardization"><span class="Hyperlink DefaultParagraphFont " style="color: #0645AD;font-family: Arial;font-size: 8.0pt;">ISO</span></a><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">/</span><a href="http://en.wikipedia.org/wiki/International_Electrotechnical_Commission"><span class="Hyperlink DefaultParagraphFont " style="color: #0645AD;font-family: Arial;font-size: 8.0pt;">IEC</span></a><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">'s</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><a href="http://en.wikipedia.org/wiki/International_Organization_for_Standardization&#10;            #ISO.2FIEC_Joint_Technical_Committee_1"><span class="Hyperlink DefaultParagraphFont " style="color: #0645AD;font-family: Arial;font-size: 8.0pt;">Joint Technical Committee 1</span></a><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">(where they became</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="font-weight: bold;color: #000000;font-family: Arial;font-size: 8.0pt;">ISO/IEC 29500:2008</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Arial;font-size: 8.0pt;">).</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">The Ecma-376.htm link also contains the 2nd edition documents (of Dec 2008), which are </span><span class="apple-converted-space DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;">"</span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;">technically aligned with ISO/IEC 29500".</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;">Office 2007 SP2 implements ECMA-376 1st Edition</span><span class="FootnoteReference DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;"><span style="vertical-align: top; font-size: xx-small"><a name="fs3"><a href="#fn3">3</a></a></span></span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;">; this is what docx4j implements.</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;">ISO/IEC 29500 (</span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Verdana;font-size: 8.5pt;">ECMA-376 2nd Edition) has</span><span class="apple-converted-space DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-style: italic;font-family: Arial;font-size: 8.5pt;">Strict</span><span class="apple-converted-space DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;">and</span><span class="apple-converted-space DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-style: italic;font-family: Arial;font-size: 8.5pt;"><span style="white-space:pre-wrap;">Transitional </span></span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;">conformance classes.  Office 2010 supports</span><span class="FootnoteReference DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;"><span style="vertical-align: top; font-size: xx-small"><a name="fs4"><a href="#fn4">4</a></a></span></span><span class="apple-style-span DefaultParagraphFont " style="color: #333333;font-family: Arial;font-size: 8.5pt;"><span style="white-space:pre-wrap;"> transitional, and also has read only support for strict.</span></span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Architecture</span></p>
  
  <p class="Normal DocDefaults ">Docx4j has 3 layers:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;">1. </span><span style="font-weight: bold;font-family: Consolas;">org.docx4j.openpackaging</span><br clear="all" /><br clear="all" /><span style="white-space:pre-wrap;">OpenPackaging handles things at the Open Packaging Conventions level:  unzipping a docx into </span><span style="font-weight: bold;font-family: Consolas;">WordprocessingMLPackage</span><span style="white-space:pre-wrap;"> and a set of objects inheriting from Part;  allowing parts to be added/deleted; saving the docx</span><br clear="all" /><br clear="all" /><span style="white-space:pre-wrap;">This layer is based originally on OpenXML4J (which is also used by Apache POI). </span><br clear="all" /></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;">2. </span><span style="white-space:pre-wrap;">Parts are generally subclasses of </span><span style="font-weight: bold;color: #000000;font-family: Consolas;">org</span><span style="font-weight: bold;font-family: Consolas;">.docx4j.</span><span style="font-weight: bold;color: #000000;font-family: Consolas;">openpackaging</span><span style="font-weight: bold;font-family: Consolas;">.parts.JaxbXmlPart</span><br clear="all" /><br clear="all" /><span style="white-space:pre-wrap;">This (the </span><span style="font-weight: bold;color: #000000;">jaxb</span><span style="font-weight: bold;"><span style="white-space:pre-wrap;"> content tree</span></span>) is the second level of the three layered model.<br clear="all" /><br clear="all" /><span style="white-space:pre-wrap;">Parts are arranged in a tree.  If a part has descendants, it will have a </span><span style="font-weight: bold;font-family: Consolas;">org.docx4j.openpackaging.parts.relationships.RelationshipsPart</span><span style="white-space:pre-wrap;"> which identifies those descendant parts.  The sample PartsList (see next section) shows you how this works.</span><br clear="all" /><br clear="all" />A JaxbXmlPart has a content tree:<br clear="all" /><br clear="all" /><span style="font-family: Consolas;font-size: 9.0pt;">   public Object getJaxbElement() {</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;">   </span><span style="font-family: Consolas;font-size: 9.0pt;">   return jaxbElement;</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;">   }</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;">   public void setJaxbElement(Object jaxbElement) {</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;">   </span><span style="font-family: Consolas;font-size: 9.0pt;">   this.jaxbElement = jaxbElement;</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="font-family: Consolas;font-size: 9.0pt;">   }</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span></p>
  
  <p class="ListParagraph Normal DocDefaults "><span style="white-space:pre-wrap;">Most parts (including MainDocumentPart, styles, headers/footers, comments, </span><span style="color: #000000;">endnotes</span><span style="white-space:pre-wrap;">/footnotes) use </span><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/wml"><span style="font-weight: bold;font-family: Consolas;">org.docx4j.wml</span></a><span style="font-weight: bold;font-family: Consolas;"><span style="white-space:pre-wrap;"> </span></span><span style="white-space:pre-wrap;">(WordprocessingML); </span><span style="color: #000000;">wml</span><span style="white-space:pre-wrap;"> references </span><a href="http://dev.plutext.org/trac/docx4j/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/wml"><span style="font-weight: bold;font-family: Consolas;">org.docx4j.dml</span></a><span style="font-weight: bold;font-family: Consolas;"><span style="white-space:pre-wrap;"> </span></span>(DrawingML) as necessary.<br clear="all" /><br clear="all" />These classes were generated from the Open XML schemas<br clear="all" /></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;">3. </span><span style="font-weight: bold;font-family: Consolas;">org.docx4j.model</span><span style="font-weight: bold;font-family: Consolas;"><br clear="all" /></span><span style="font-weight: bold;font-family: Consolas;"><br clear="all" /></span><span style="white-space:pre-wrap;">This package builds on the lower two layers to provide extra functionality, and is being progressively further developed.    </span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;"><span style="white-space:pre-wrap;">Jaxb: marshalling and unmarshalling </span></span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Docx4j contains a class representing each part.  For example, there is a </span><span style="font-family: Consolas;">MainDocumentPart</span><span style="white-space:pre-wrap;"> class.  XML parts inherit from </span><span style="font-family: Consolas;">JaxbXmlPart</span><span style="white-space:pre-wrap;">, which contains a member called </span><span style="font-weight: bold;font-family: Consolas;">jaxbElement</span>.  When you want to work with the contents of a part, you work with its jaxbElement.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">When you open a docx document using docx4j, docx4j automatically </span><span style="font-weight: bold;font-style: italic;">unmarshals</span><span style="white-space:pre-wrap;"> the contents of each XML part to a strongly-type Java object tree (the jaxbElement).</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Similarly, if/when you tell docx4j to save these Java objects as a docx, docx4j automatically </span><span style="font-weight: bold;font-style: italic;">marshals</span><span style="white-space:pre-wrap;"> the jaxbElement in each Part.</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Sometimes you will want to marshal or unmarshal things yourself.  The class </span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.jaxb.Context</span><span style="white-space:pre-wrap;"> defines all the JAXBContexts used in docx4j: </span></p>
  
  <table class="TableGrid TableNormal " id="docx4j_tbl_1" style="position: relative; margin-left: 0.76in;table-layout: fixed;border-collapse: collapse;"><colgroup><col style="width: 2in;" /><col style="width: 2.94in;" /></colgroup><tbody><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="font-family: Consolas;font-size: 9.0pt;">Jc</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.dml</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.dml.picture</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.dml.wordprocessingDrawing</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.vml</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.vml.officedrawing</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.math</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcThemePart</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.dml</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcDocPropsCore</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.docProps.core</span></p>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.docProps.core.dc.elements</span></p>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.docProps.core.dc.terms</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcDocPropsCustom</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.docProps.custom</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcDocPropsExtended</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.docProps.extended</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcXmlPackage</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.xmlPackage</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcRelationships</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.relationships</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcCustomXmlProperties</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.customXmlProperties</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcContentTypes</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.openpackaging.contenttype</span></p></td></tr><tr style="vertical-align: top;"><td style="vertical-align: middle;">
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">jcPML</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.pml</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.dml</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;"><br clear="all" />org.docx4j.dml.picture</span></p></td></tr></tbody></table>
  
  <p class="Normal DocDefaults " />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Parts List</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">To get a better understanding of how docx4j works – and the structure of a docx document – you can run the PartsList sample on a docx (or a pptx or xlsx).  If you do, it will list the hierarchy of parts used in that package.  It will tell you which class is used to represent each part, and where that part is a JaxbXmlPart, it will also tell you what class the </span><span style="font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">jaxbElement </span></span>is.</p>
  
  <p class="Normal DocDefaults ">You can run it from a command line:</p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Courier New;font-size: 6.5pt;">   java -cp docx4j.jar:log4j-1.2.15.jar org.docx4j.samples.PartsList [input.docx]</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">If there are any images in the docx, you'd also need to add to your classpath: xmlgraphics-commons-1.4.jar and commons-logging-1.1.1.jar</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">For example: </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">Part /_rels/.rels [org.docx4j.openpackaging.parts.relationships.RelationshipsPart]</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.relationships.Relationships</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">Part /docProps/app.xml [org.docx4j.openpackaging.parts.DocPropsExtendedPart]  </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.docProps.extended.Properties</span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">Part /docProps/core.xml [org.docx4j.openpackaging.parts.DocPropsCorePart]  </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.docProps.core.CoreProperties</span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">Part </span></span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 8.0pt;">/word/document.xml</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> [org.docx4j.openpackaging.parts.WordprocessingML.MainDocumentPart]  </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.wml.Document</span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">Part /word/settings.xml [</span><span style="color: #000000;font-family: Consolas;font-size: 7.0pt;">org.docx4j.openpackaging.parts.WordprocessingML</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">.DocumentSettingsPart]  </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.wml.CTSettings</span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">Part /word/styles.xml [</span><span style="color: #000000;font-family: Consolas;font-size: 7.0pt;">org.docx4j.openpackaging.parts.WordprocessingML</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">.StyleDefinitionsPart]  </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">  containing JaxbElement:org.docx4j.wml.Styles</span></span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">Part /word/media/image1.jpeg [</span><span style="color: #000000;font-family: Consolas;font-size: 7.0pt;">org.docx4j.openpackaging.parts.WordprocessingML</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">.ImageJpegPart] </span></span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults ">docx4j includes convenience methods to make it easy to access commonly used parts. These include,</p>
  
  <p class="Normal DocDefaults ">on the package:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> MainDocumentPart getMainDocumentPart() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> DocPropsCorePart getDocPropsCorePart() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> DocPropsExtendedPart getDocPropsExtendedPart() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> DocPropsCustomPart getDocPropsCustomPart() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">on the document part:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> StyleDefinitionsPart getStyleDefinitionsPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> NumberingDefinitionsPart getNumberingDefinitionsPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> ThemePart getThemePart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> FontTablePart getFontTablePart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> CommentsPart getCommentsPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> EndnotesPart getEndNotesPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> FootnotesPart getFootnotesPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> DocumentSettingsPart getDocumentSettingsPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> WebSettingsPart getWebSettingsPart()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">If a part points to any other parts, it will have a relationships part listing these other parts. </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   RelationshipsPart rp = part.getRelationshipsPart();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">You can access those, and from there, get the part you want:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">for</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> ( Relationship r : rp.getRelationships().getRelationship() ) {</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #0000C0;font-style: italic;font-family: Courier New;font-size: 8.0pt;">log</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">.info(</span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">"\nFor Relationship Id="</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> + r.getId() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">+ </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">" Source is "</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> + rp.getSourceP().getPartName() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">+ </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">", Target is "</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> + r.getTarget() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">+ </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">" type "</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> + r.getType() + </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">"\n"</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   Part part = rp.getPart(r);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   }</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults ">That gives access to just the parts this part points to.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">There is also a list of </span><span style="font-weight: bold;">all</span><span style="white-space:pre-wrap;"> parts, in the package object:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   Parts parts = wordMLPackage.getParts();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;">The Parts object encapsulates a map of parts, keyed by PartName.</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">To add a part, see the section </span>Adding a Part<span style="white-space:pre-wrap;"> below.</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">MainDocumentPart</span></p>
  
  <p class="Normal DocDefaults ">The text of the document is to be found in the main document part.</p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">Given:</p>
  
  <p class="Normal DocDefaults "><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">WordprocessingMLPackage wordMLPackage</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">you can access:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">Classically, you'd then do:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   <span style="white-space:pre-wrap;">org.docx4j.wml.Document wmlDocumentEl </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   = (org.docx4j.wml.Document) documentPart.getJaxbElement();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   Body body = wmlDocumentEl.getBody();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">But as from 2.7.0, there is:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">     * Convenience method to getJaxbElement().getBody().getContent()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">     * </span></span><span style="font-weight: bold;color: #7F9FBF;font-family: Courier New;font-size: 10.0pt;">@since</span><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> 2.7</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">     */</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> List&lt;Object&gt; getContent() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">A paragraph is org.docx4j.wml.P; a paragraph is basically made up of runs of text.</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="color: #646464;font-family: Courier New;font-size: 10.0pt;">@</span><span style="color: #646464;font-family: Courier New;font-size: 10.0pt;text-decoration: none;">XmlRootElement</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">(name = </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 10.0pt;">"p"</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">)</span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">class</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> P </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">implements</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> Child, ContentAccessor</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">The </span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">ContentAccessor</span><span style="white-space:pre-wrap;"> interface is simply:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> * </span></span><span style="font-weight: bold;color: #7F9FBF;font-family: Courier New;font-size: 10.0pt;">@since</span><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> 2.7</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #3F5FBF;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> */</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">interface</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #000000;background-color: lightGray;font-family: Courier New;font-size: 10.0pt;">ContentAccessor</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> {</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> List&lt;Object&gt; getContent();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;">}</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">it is implemented by a number of objects, including:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>P, R (R is for run, which is where the document text lives)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Hdr, Ftr</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>table related objects (Tbl, Tc, Tr)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>content control objects</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Samples</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">The package org.docx4j.samples contains examples of how to do things with docx4j.  There are pptx and xlsx samples in packages org.pptx4j.samples and org.xlsx4j.samples respectively.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">The docx4j samples include:</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Basics</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CreateWordprocessingMLDocument</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>DisplayMainDocumentPartXml</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>OpenAndSaveRoundTripTest</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>OpenMainDocumentAndTraverse</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>XPathQuery (2010 07 13 nightly or later only)</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Output/Transformation</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CreateHtml</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CreatePdf</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">Flat OPC XML </span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ExportInPackageFormat</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ImportFromPackageFormat</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">Image handling </span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>AddImage</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ConvertEmbeddedImageToLinked</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Part Handling</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CopyPart</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ImportForeignPart</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>PartsList</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>StripParts</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Document generation/document assembly using content controls</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>AltChunk</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CreateDocxWithCustomXml</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CustomXmlBinding</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ContentControlBindingExtensions</p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 0.25in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Miscellaneous</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>CompareDocuments</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>DocProps</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>Filter</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>HyperlinkTest</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>NumberingRestart</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>UnmarshallFromTemplate</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">If you installed the source code, you'll have this package already.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">If you didn't, you can browse it online, at </span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples"><span class="Hyperlink DefaultParagraphFont " style="font-size: 10.0pt;">http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples</span></a></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">There are also various </span><span style="font-weight: bold;">sample documents</span><span style="white-space:pre-wrap;"> in the /sample-docs directory; these are most easily accessed by checking out docx4j svn.</span></p>
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="position: relative; margin-left: 1in;space-after: 0in;line-height: 100%;" />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Creating a new docx</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0.07in;line-height: 100%;">To create a new docx:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the package</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Save it</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-family: Consolas;font-size: 9.0pt;">wordMLPackage.save(new java.io.File("helloworld.docx") );</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">That's it.  </span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">createPackage() </span></span>is a convenience method, which does:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the package</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">WordprocessingMLPackage wordMLPackage = new WordprocessingMLPackage();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the main document part (word/document.xml)</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-family: Consolas;font-size: 9.0pt;">MainDocumentPart wordDocumentPart = new MainDocumentPart();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create main document part content</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">ObjectFactory factory = Context.getWmlObjectFactory();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.Body body = factory .createBody();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.Document wmlDocumentEl = factory .createDocument();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wmlDocumentEl.setBody(body);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Put the content in the part</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wordDocumentPart.setJaxbElement(wmlDocumentEl);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">            </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Add the main document part to the package relationships</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// (creating it if necessary)</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wmlPack.addTargetPart(wordDocumentPart);</span></p>
  
  <p class="Heading1 Normal DocDefaults "><a name="_Ref273525601" />Adding a paragraph of text</p>
  
  <p class="Normal DocDefaults "><span style="font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">MainDocumentPart </span></span>contains a method:</p>
  
  <p class="Normal DocDefaults "><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.P addStyledParagraphOfText(String styleId, String text)</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">You can use that method to add a paragraph using the specified style.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">The XML we are looking to create will be something like:</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;"><span style="white-space:pre-wrap;">w:p </span></span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;"> </span><span class="xmlmarkupattributename DefaultParagraphFont " style="color: #FF0000;font-family: Consolas;font-size: 8.5pt;">xmlns:w</span><span class="xmlmarkupattributevalue DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">="http://schemas.openxmlformats.org/wordprocessingml/2006/main"</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">    </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:r</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">        </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:t</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">Hello world</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:t</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">    </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:r</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:p</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">addStyledParagraphOfText </span></span>builds the object structure “the JAXB way”, and adds it to the document.</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">ObjectFactory factory = Context.getWmlObjectFactory();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the paragraph</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.P  para = factory.createP();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the text element</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.Text  t = factory.createText();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">t.setValue(simpleText);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create the run</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.R  run = factory.createR();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">run.getRunContent().add(t);    </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">para.getParagraphContent().add(run);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Now add our paragraph to the document body</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">Body body = this.jaxbElement.getBody();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">Body.getEGBlockLevelElts().add(para)</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Notice that adding a paragraph involves:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">Body.getEGBlockLevelElts().add(para)</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Similarly, the paragraph object P has:</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 9.0pt;">   public</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> List&lt;Object&gt; getParagraphContent()</span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="color: #000000;font-family: Calibri;">and the run object:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 9.0pt;">   public</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> List&lt;Object&gt; getRunContent() </span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Alternatively, you can create the paragraph by marshalling XML:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Assuming String xml contains the XML above</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.P  para = XmlUtils.unmarshalString(xml);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">For this to work, you need to ensure that all namespaces are declared properly in the string.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">See further below for adding images, and tables.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Traversing a document</span></p>
  
  <p class="Normal DocDefaults "><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples/OpenMainDocumentAndTraverse.java"><span style="color: #0000FF;text-decoration: none;">OpenMainDocumentAndTraverse.java</span></a><span style="white-space:pre-wrap;"> in the samples directory shows you how to traverse the JAXB representation of a docx.  </span></p>
  
  <p class="Normal DocDefaults ">You can run it from a command line:</p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Courier New;font-size: 6.5pt;">   java -cp docx4j.jar:log4j-1.2.15.jar org.docx4j.samples.OpenMainDocumentAndTraverse [input.docx]</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">If there are any images in the docx, you'd also need to add to your classpath: xmlgraphics-commons-1.4.jar and commons-logging-1.1.1.jar</span></p>
  
  <p class="Normal DocDefaults ">This sample is useful if you want to see what objects are used in your document.xml.</p>
  
  <p class="Normal DocDefaults ">This is an alternative to XSLT, which doesn't require marshalling/unmarshalling.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">The sample uses TraversalUtil, which is a general approach for traversing the JAXB object tree in the main document part.  It can also be applied to headers, footers etc.   TraversalUtil has an </span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">interface</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> Callback, </span></span>which you use to specify how you want to traverse the nodes, and what you want to do to them.</p>
  
  <p class="Normal DocDefaults ">As noted in "Adding a paragraph of text<span style="white-space:pre-wrap;">" above,  many objects (eg the document body, a paragraph, a run), have a List containing  their content (see </span><span style="font-family: Calibri;">The ContentAccessor interface</span><span style="white-space:pre-wrap;"> further below).  Traversal works by iterating over these lists. </span></p>
  
  <p class="Heading1 Normal DocDefaults "><a name="_Ref273526076" /><span style="font-family: Calibri;">General strategy/approach for creating stuff</span></p>
  
  <p class="Normal DocDefaults ">The first thing you need to know is what the XML you are trying to create looks like.</p>
  
  <p class="Normal DocDefaults ">To figure this out, start with a docx that contains the construct (create it in Word if necessary).</p>
  
  <p class="Normal DocDefaults ">Now look at its XML. Choices:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">You can unzip it to do this </span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">easiest may be to save it as Flat OPC XML from Word (or use the </span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">ExportInPackageFormat</span><span style="white-space:pre-wrap;"> sample),  so you have just a single XML file which you don't need to unzip</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">you can use the </span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">DisplayMainDocumentPartXml </span></span><span style="color: #000000;font-family: Calibri;">to get it</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;">you can open it with docx4all, and look at the source view</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;">on Windows, if you have Visual Studio 2010, you can drag the docx onto it</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;">on Windows, get PackageExplorer from codeplex.</span></p>
  
  <p class="Normal DocDefaults ">Now you are ready to create this XML using JAXB.  There are 2 basic ways.</p>
  
  <p class="Normal DocDefaults ">The classic JAXB way is to use the ObjectFactory's .createX methods.  For example:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">       ObjectFactory factory = Context.</span></span><span style="color: #000000;font-style: italic;font-family: Courier New;font-size: 9.0pt;">getWmlObjectFactory</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">();</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">   </span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">        </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">       P p = factory.createP();</span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">The challenge with this is to know what object it is you are trying to create.  To find this out, run </span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">OpenMainDocumentAndTraverse </span></span>on your document.</p>
  
  <p class="Normal DocDefaults ">Here are the names for some common objects:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <table class="TableGrid TableNormal " id="docx4j_tbl_2" style="position: relative; margin-left: 0.37in;table-layout: fixed;border-collapse: collapse;"><colgroup><col style="width: 0.98in;" /><col style="width: 0.89in;" /><col style="width: 1.66in;" /><col style="width: 40mm;" /></colgroup><tbody><tr style="vertical-align: top;"><td style="background-color: #D9D9D9;">
  
  <p class="Normal DocDefaults "><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 9.0pt;">Object</span></p></td><td style="background-color: #D9D9D9;">
  
  <p class="Normal DocDefaults "><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 9.0pt;">XML element</span></p></td><td style="background-color: #D9D9D9;">
  
  <p class="Normal DocDefaults "><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 9.0pt;">docx4j class</span></p></td><td style="background-color: #D9D9D9;">
  
  <p class="Normal DocDefaults "><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 9.0pt;">Factory method</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Document body</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:body</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Body</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createBody();</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Paragraph</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:p</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.P</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createP()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Paragraph props</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:pPr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.PPr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createPPr()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Run</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:r</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.R</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createR()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Run props</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:rPr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.RPr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createRPr()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Text</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:t</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Text</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createText()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Table</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:tbl</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Tbl</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createTbl()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Table row</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:tr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Tr</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createTr()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Table cell</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:tc</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Tc</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createTc()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Drawing</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:drawing</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Drawing</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createDrawing()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">Page break</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">w:br</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.Br</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createBr()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;"><span style="white-space:pre-wrap;">Footnote </span></span><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;"><br clear="all" />or endnote ref</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">?</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">org.docx4j.wml.CTFtnEdnRef</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 9.0pt;">factory.createCTFtnEdnRef()</span></p></td></tr></tbody></table>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;"> </span></p>
  
  <p class="Normal DocDefaults ">An easier way may be to just unmarshal the  XML (eg a String representing a paragraph to be inserted into the document).</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">For example, given:</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;"><span style="white-space:pre-wrap;">w:p </span></span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;"> </span><span class="xmlmarkupattributename DefaultParagraphFont " style="color: #FF0000;font-family: Consolas;font-size: 8.5pt;">xmlns:w</span><span class="xmlmarkupattributevalue DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">="http://schemas.openxmlformats.org/wordprocessingml/2006/main"</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">    </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:r</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">        </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:t</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">Hello world</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:t</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.5pt;">    </span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:r</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 8.5pt;"><br clear="all" /></span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&lt;/</span><span class="xmlmarkuptagname DefaultParagraphFont " style="color: #A31515;font-family: Consolas;font-size: 8.5pt;">w:p</span><span class="xmlmarkupbracket DefaultParagraphFont " style="color: #0000FF;font-family: Consolas;font-size: 8.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">you can simply:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Assuming String xml contains the XML above</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.P  para = XmlUtils.unmarshalString(xml);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">Problems?  See </span><span style="white-space:pre-wrap;"> below.</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">If you need to be explicit about the type, you can use:</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 9.0pt;">Object unmarshalString(String str, JAXBContext jc, Class declaredType)</span></p>
  
  <p class="Heading1 Normal DocDefaults "><a name="_Ref290751180" /><span style="font-family: Calibri;">The ContentAccessor interface</span></p>
  
  <p class="Normal DocDefaults ">The forthcoming docx4j 2.7.0 (and current svn and nightly builds) introduces a content accessor interface.</p>
  
  <p class="Normal DocDefaults ">This interface contains a single method:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 10.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> List&lt;Object&gt; getContent();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">It is implemented for a number of objects, including the following:</p>
  
  <table class="TableGrid TableNormal " id="docx4j_tbl_3" style="position: relative; margin-left: 0.86in;table-layout: fixed;border-collapse: collapse;"><colgroup><col style="width: 1.77in;" /><col style="width: 32mm;" /><col style="width: 55mm;" /></colgroup><tbody><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Body</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:body</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">document body</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">P</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:p</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">paragraph</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">R</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:r</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">run</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tbl</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tr</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tc</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:tbl</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:tr</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:tc</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">table</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">table row</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">table cell</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">SdtBlock</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">SdtRun</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">CTSdtRow</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">CTSdtCell</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:sdt</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:sdt</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:sdt</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">w:sdt</span></p></td><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">content controls; see the method</span><span style="color: #000000;font-family: Courier New;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> getSdtContent()</span></span></p></td></tr></tbody></table>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults ">In earlier versions of docx4j (including the current 2.6.0), each of these classes had a different name for the method which returns the list of content objects:</p>
  
  <table class="TableGrid TableNormal " id="docx4j_tbl_4" style="position: relative; margin-left: 0.86in;table-layout: fixed;border-collapse: collapse;"><colgroup><col style="width: 1.77in;" /><col style="width: 3.36in;" /></colgroup><tbody><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Body</span></p></td><td>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getEGBlockLevelElts()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">P</span></p></td><td>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getParagraphContent()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">R</span></p></td><td>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getRunContent()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tbl</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tr</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">Tc</span></p></td><td>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getEGContentRowContent()</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getEGContentCellContent()</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getEGBlockLevelElts()</span></p></td></tr><tr style="vertical-align: top;"><td>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">SdtBlock</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">SdtRun</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">CTSdtRow</span></p>
  
  <p class="Normal DocDefaults "><span style="font-size: 10.0pt;">CTSdtCell</span></p></td><td>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getSdtContent().getEGContentBlockContent()</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getSdtContent().getParagraphContent()</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getSdtContent().getEGContentRowContent()</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0mm;"><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">getSdtContent().getEGContentCellContent()</span></p></td></tr></tbody></table>
  
  <p class="Normal DocDefaults " />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Creating and adding a table</span></p>
  
  <p class="Normal DocDefaults "><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/model/table/TblFactory.java">org.docx4j.model.table.TblFactory</a><span style="white-space:pre-wrap;"> provides an easy way to create a simple table. For an example of its use, see the </span><a href="http://dev.plutext.org/trac/docx4j/browser/trunk/docx4j/src/main/java/org/docx4j/samples/CreateWordprocessingMLDocument.java">CreateWordprocessingMLDocument sample</a>.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">If you want to know what you need to add to format your table (make it prettier), see </span><span style="white-space:pre-wrap;"> above.</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;"><span style="white-space:pre-wrap;">Selecting your insertion/editing point; </span></span><span style="font-family: Calibri;"><br clear="all" />accessing JAXB nodes via XPath</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Sometimes, XPath is a succinct way to select the things you need to change.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Happily, from docx4j 2.<span style="font-weight: bold;">5</span>.0, you can do use XPath to select JAXB nodes:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">String xpath = </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">"//w:p"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">;</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">List&lt;Object&gt; list = documentPart.getJAXBNodesViaXPath(xpath, </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">false</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">These JAXB nodes are live, in the sense that if you change them, your document changes.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">There is a limitation however: the xpath expressions are evaluated against the XML document as it was when first opened in docx4j.  You can update the associated XML document once only, by passing true into </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">getJAXBNodesViaXPath</span>. Updating it again (with current JAXB 2.1.x or 2.2.x) will cause an error.</p>
  
  <p class="Heading1 Normal DocDefaults "><a name="_Ref275255216" />Adding a Part</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">What if you wanted to add a new styles part? Here's how:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Create a styles part</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">StyleDefinitionsPart stylesPart = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">StyleDefinitionsPart();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Populate it with default styles</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">stylesPart.unmarshalDefaultStyles();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Add the styles part to the main document part relationships</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wordDocumentPart.addTargetPart(stylesPart);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">You'd take the same approach to add a header or footer.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">When you add a part this way, it is automatically added to the source part's relationships part.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">Generally, you'll also need to add a reference to the part (using its relationship id) to the Main Document Part.  This applies to images, headers and footers. (Comments, footnotes and endnotes are a </span>bit different, in that what you add to the main document part are references to individual comments/footnotes/endnotes).</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">docx to (X)HTML</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">docx4j uses XSLT to transform a docx to XHTML:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">AbstractHtmlExporter exporter = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">HtmlExporterNG2();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">        </span></span><span style="color: #3F7F5F;font-family: Courier New;font-size: 9.0pt;">// note the *2* there</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Write to StreamResult (in this case, an output stream)</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">OutputStream os = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">java.io.FileOutputStream(inputfilepath + </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 9.0pt;">".html"</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">javax.xml.transform.stream.StreamResult result </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><br clear="all" /></span><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">           </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">= </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">javax.xml.transform.stream.StreamResult(os);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">exporter.html(wordMLPackage, result, </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">             </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">inputfilepath + </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 9.0pt;">"_files"</span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">You will find the generated HTML is clean.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">Docx4j uses Java XSLT extension functions to do the heavy lifting, so the XSLT itself is kept simple.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">If you have log4j debug level logging enabled for </span><span style="font-weight: bold;font-family: Consolas;font-size: 9.0pt;">org.docx4j.convert.out.html.HtmlExporterNG2</span><span style="white-space:pre-wrap;">, anything which is not implemented will be obvious in the output document.  </span><span style="font-weight: bold;font-style: italic;">If debug level logging is not switched on, unsupported elements will be silently dropped.</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">The XSLT can be found at </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j/src/main/java/org/docx4j/convert/out/html/docx2xhtmlNG2.xslt"><span class="Hyperlink DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">src/main/java/org/docx4j/convert/out/html/docx2xhtmlNG2.xslt</span></a></p>
  
  <p class="normal0 Normal DocDefaults " style="line-height: 75%;"><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">There are several ways to customise the HTML output.</span></p>
  
  <p class="listparagraph0 Normal DocDefaults " style="position: relative; margin-left: 0.25in;line-height: 75%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">one of course is to alter the xslt itself. This should be avoided, unless your objective is to improve the fidelity of the output (in which case, please contribute a patch!)</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /><span style="white-space:pre-wrap;">To substitute your own XSLT, you can use the </span></span><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">HtmlExporterNG2 </span></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">method:</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">   </span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">static</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">void</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> setXslt(Templates xslt)</span></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span></p>
  
  <p class="listparagraph0 Normal DocDefaults " style="position: relative; margin-left: 0.25in;line-height: 75%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><span style="white-space:pre-wrap;">another possibility (currently in svn trunk only) is to register an </span></span><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 11.0pt;">SdtTagHandler</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">.</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" />An SdtTagHandler allows you to wrap SdtContent (Content Control content) in arbitrary HTML (for example, a &lt;div&gt; with a particular class attribute, or style attribute, or associated javascript).</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" />The design envisages different tag handlers being applied depending on the value of w:sdt/w:sdtPr/w:tag (hence the name tag handler). The content of a tag should be name/value pairs delimited like a URL query string.</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" /></span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><br clear="all" />For further details, please see the SdtWriter class.</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;" />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">docx to PDF</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">docx4j produces XSL FO, which can in turn be used to create a PDF.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">At present, Apache FOP is integrated into docx4j for creating the PDF.  (Soon, we will be changing things so that docx4j generates FO, for use by your preferred FO renderer, whether that's FOP, or a commercial tool such as XEP).</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">To create a PDF:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Fonts identity mapping – best on Microsoft Windows</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wordMLPackage.setFontMapper(</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">IdentityPlusMapper());</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Set up converter</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">org.docx4j.convert.out.pdf.PdfConversion c </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">          </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">= </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.convert.out.pdf.viaXSLFO.Conversion(wordMLPackage);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;">// Write to output stream</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">OutputStream os = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">new </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">java.io.FileOutputStream(inputfilepath + </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">".pdf"</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">);      </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">c.output(os);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">See the CreatePdf sample.</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">If you have log4j debug level logging enabled for </span><span style="font-weight: bold;font-family: Consolas;font-size: 9.0pt;">org.docx4j.convert.out.pdf.viaXSLFO</span><span style="white-space:pre-wrap;">, anything which is not implemented will be obvious in the output document.  In addition, the logs will contain the intermediate XSL FO for inspection.  </span><span style="font-weight: bold;font-style: italic;">If debug level logging is not switched on, unsupported elements will be silently dropped.</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">The XSLT can be found at </span><a href="http://dev.plutext.org/svn/docx4j/trunk/docx4j/src/main/java/org/docx4j/convert/out/pdf/viaXSLFO/docx2fo.xslt"><span style="white-space:pre-wrap;"> </span><span class="Hyperlink DefaultParagraphFont " style="font-family: Consolas;font-size: 10.0pt;">src/main/java/org/docx4j/convert/out/pdf/viaXSLFO/docx2fo.xslt</span></a></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;" />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Fonts</span></p>
  
  <p class="Normal DocDefaults ">When docx4j is used to create a PDF, it can only use fonts which are available to it.</p>
  
  <p class="Normal DocDefaults ">These fonts come from 2 sources:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>those installed on the computer</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>those embedded in the document</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Note that Word silently performs </span><span style="font-weight: bold;font-style: italic;">font substitution</span><span style="white-space:pre-wrap;">.  When you open an existing document in Word, and select text in a particular font, the actual font you see on the screen won't be the font reported in the ribbon if it is not installed on your computer or embedded in the document.  To see whether Word 2007 </span><span style="white-space:pre-wrap;">is substituting a font, go into Word Options &gt; Advanced &gt; Show Document Content and press the "Font Substitution" button.  </span></p>
  
  <p class="Normal DocDefaults ">Word's font substitution information is not available to docx4j.  As a developer, you 3 options:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>ensure the font is installed or embedded</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>tell docx4j which font to use instead, or</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>allow docx4j to fallback to a default font</p>
  
  <p class="Normal DocDefaults ">To embed a font in a document, open it in Word on a computer which has the font installed (check no substitution is occuring), and go to Word Options &gt; Save &gt; Embed Fonts in File.</p>
  
  <p class="Normal DocDefaults ">If you want to tell docx4j to use a different font, you need to add a font mapping.  The FontMapper interface is used to do this.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">On a Windows computer, font names for installed fonts are mapped 1:1 to the corresponding physical fonts via the IdentityPlusMapper. </span></p>
  
  <p class="Normal DocDefaults ">A font mapper contains Map&lt;String, PhysicalFont&gt;; to add a font mapping, as per the example in the CreatePdf sample:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #3F7F5F;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">// Set up font </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 8.0pt;text-decoration: none;">mapper</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">Mapper fontMapper = </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> IdentityPlusMapper();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   wordMLPackage.setFontMapper(fontMapper);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #3F7F5F;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">// Example of mapping missing font Algerian to installed font Comic </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 8.0pt;text-decoration: none;">Sans</span><span style="color: #3F7F5F;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> MS</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   PhysicalFont font = PhysicalFonts.</span><span style="color: #000000;font-style: italic;font-family: Consolas;font-size: 8.0pt;">getPhysicalFonts</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">().get(</span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">"Comic Sans MS"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   fontMapper.getFontMappings().put(</span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">"Algerian"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">, font);</span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">You'll see the font names if you configure log4j debug level logging for </span><span style="font-weight: bold;font-family: Consolas;font-size: 9.0pt;">org.docx4j.fonts.PhysicalFonts</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Image Handling</span></p>
  
  <p class="Normal DocDefaults ">When you add an image to a document in Word 2007, it is generally added as a new Part (ie you'll find a part in the resulting docx, containing the image in base 64 format).</p>
  
  <p class="Normal DocDefaults ">When you open the document in docx4j, docx4j will create an image part representing it.</p>
  
  <p class="Normal DocDefaults ">It is also possible to create a “linked” image.  In this case, the image is not embedded in the docx package, but rather, is referenced at its external location.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Docx4j's </span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 10.0pt;">BinaryPartAbstractImage</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span>class contains methods to allow you to create both embedded and linked images (along with appropriate relationships).</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* Create an image part from the provided byte array, attach it to the </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* main document part, and return it.*/</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">BinaryPartAbstractImage createImagePart(WordprocessingMLPackage wordMLPackage,</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;">byte</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">[] bytes) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* Create an image part from the provided byte array, attach it to the source part</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* (eg the main document part, a header part etc), and return it.*/</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">BinaryPartAbstractImage createImagePart(WordprocessingMLPackage wordMLPackage,</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">Part sourcePart, </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;">byte</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">[] bytes) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* Create a linked image part, and attach it as a rel of the specified source part</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* (eg a header part)</span><span style="font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">*/</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">BinaryPartAbstractImage createLinkedImagePart(</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">WordprocessingMLPackage wordMLPackage, Part sourcePart, String fileurl) </span></span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults ">For an image to appear in the document, there also needs to be appropriate XML in the main document part.  This XML can take 2 basic forms:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">the Word 2007 </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:drawing</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span>form</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&lt;w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;w:drawing&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;wp:inline </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">distT</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="0" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">distB</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="0" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">distL</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="0" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">distR</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="0"</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;wp:extent </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">cx</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="3238500" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">cy</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="2362200" /</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;wp:effectExtent </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">l</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="19050" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">t</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="0" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">r</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="0" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">b</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="0" /</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;a:graphic &gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;a:graphicData </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> ..</span></span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;pic:pic &gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;pic:blipFill&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="font-weight: bold;color: #800000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">a:blip </span></span><span style="font-weight: bold;color: #FF0000;font-family: Consolas;font-size: 9.0pt;">r:embed</span><span style="font-weight: bold;color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="rId5"</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> /</span></span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">pic:blipFill&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">pic:pic&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">a:graphicData&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">a:graphic&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">wp:inline&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">w:drawing&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">the Word 2003 VML-based </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:pict</span><span style="white-space:pre-wrap;"> form</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&lt;w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;w:pict&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;v:shapetype </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">id</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="_x0000_t75" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">coordsize</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">="21600,21600" </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> .. </span></span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;v:stroke </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">joinstyle</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="miter" /</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;v:formulas&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">v:formulas&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   :</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">v:shapetype&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   <span style="white-space:pre-wrap;">&lt;v:shape </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">..</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">style</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="width:428.25pt;height:321pt"</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="font-weight: bold;color: #800000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">v:imagedata </span></span><span style="font-weight: bold;color: #FF0000;font-family: Consolas;font-size: 9.0pt;">r:id</span><span style="font-weight: bold;color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="rId4"</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 9.0pt;">o:title</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">="" /</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 9.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;">v:shape&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-family: Consolas;font-size: 12.0pt;">   </span><span style="font-family: Consolas;font-size: 12.0pt;">   </span><span style="font-family: Consolas;font-size: 12.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">&lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:pict&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Docx4j can create the Word 2007 </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:drawing/wp:inline</span><span style="color: #800000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span>form for you:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* Create a </span></span><span style="color: #7F7F9F;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">&lt;wp:inline&gt; </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">element suitable for this image,</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* which can be linked or embedded in w:p/w:r/w:drawing.</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* If the image is wider than the page, it will be scaled</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* automatically.  See Javadoc for other signatures.</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* </span></span><span style="color: #7F9FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">@param </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">filenameHint Any text, for example the original filename</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* </span></span><span style="color: #7F9FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">@param </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">altText  Like HTML's alt text</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* </span></span><span style="color: #7F9FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">@param </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">id1   An id unique in the document</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* </span></span><span style="color: #7F9FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">@param </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">id2   Another id unique in the document</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">* </span></span><span style="color: #7F9FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">@param </span></span><span style="font-weight: bold;color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">link</span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  true if this is to be </span></span><span style="font-weight: bold;color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">linked not embedded</span><span style="font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">*/</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">Inline createImageInline(String filenameHint, String altText, </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">int </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">id1, </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">int </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">id2, </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">boolean </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">link) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">which you can then add to a </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:r/w:drawing.</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Finally, with docx4j, you can convert images from formats unsupported by Word (eg PDF), to PNG, which is a supported format.  For this, docx4j uses </span><span style="font-weight: bold;">ImageMagick</span>.  So if you want to use this feature, you need to install ImageMagick.  Docx4j invokes ImageMagick using:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> Process p = Runtime.getRuntime().exec(</span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">"imconvert -density " </span></span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">+ density + </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">" -units PixelsPerInch - png:-"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">);</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><br clear="all" /></span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Note the name </span><span style="font-weight: bold;">imconvert</span><span style="white-space:pre-wrap;">, which is used so that we don't have to supply a full path to exec.  You'll need to accommodate that.  </span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Manual Image Manipulation</span></p>
  
  <p class="Normal DocDefaults ">Images involve three things:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>the image part itself</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>a relationship, in the relationships part of the main document part (or header part etc).  This relationship includes:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1.02in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span><span style="white-space:pre-wrap;">the name of the image part (for example, </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">/word/media/image1.jpeg</span>)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 1.02in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Courier New;">o </span>the relationship ID</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">some XML in the main document part (or header part etc), referencing the relationship ID (see </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:drawing</span><span style="white-space:pre-wrap;"> and </span><span style="font-weight: bold;color: #800000;font-family: Consolas;">w:pict</span><span style="white-space:pre-wrap;"> examples above)</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">This means that if you are moving images around, you need to take care to ensure that the relationships remain valid. </span></p>
  
  <p class="Normal DocDefaults ">You can manually manipulate the relationship, and you can manually manipulate the XML referencing the relationship IDs.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Given an image part, you can get the relationship pointing to it </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;background-color: lightGray;font-family: Consolas;font-size: 8.0pt;">Relationship</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> rel = copiedImagePart.getSourceRelationship();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   String id = rel.getId();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">You can then ensure the reference matches.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Adding Headers/Footers</span></p>
  
  <p class="Normal DocDefaults ">See the HeaderFooter sample for how to do this.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Merging Documents</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">As</span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Calibri;font-size: 11.0pt;"> </span><a href="http://blogs.msdn.com/b/ericwhite/archive/2008/11/03/inserting-deleting-moving-paragraphs-in-open-xml-wordprocessing-documents.aspx"><span class="Hyperlink DefaultParagraphFont " style="color: #AD582A;font-family: Calibri;font-size: 11.0pt;">Eric White’s blog explained</span></a><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">, combining multiple documents can be complicated:</span></p>
  
  <p class="NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="color: #777777;font-family: Calibri;font-size: 11.0pt;">This programming task is complicated by the need to keep other parts of the document in sync with the data stored in paragraphs. For example, a paragraph can contain a reference to a comment in the comments part, and if there is a problem with this reference, the document is invalid. You must take care when moving / inserting / deleting paragraphs to maintain ‘</span><span class="Emphasis DefaultParagraphFont " style="font-weight: bold;color: #777777;font-family: Calibri;font-size: 11.0pt;">referential integrity</span><span style="color: #777777;font-family: Calibri;font-size: 11.0pt;">’ within the document.</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">There is a paid extension for docx4j, called MergeDocx, which makes merging documents as easy as invoking the method:</span></p>
  
  <p class="Normal DocDefaults "><span class="HTMLCode DefaultParagraphFont " style="font-family: Consolas;font-size: 8.0pt;">   public</span><span style="font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">  </span></span><span class="HTMLCode DefaultParagraphFont " style="font-family: Consolas;font-size: 8.0pt;">WordprocessingMLPackage merge(List&lt;WordprocessingMLPackage&gt; wmlPkgs)</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">In other words, you pass a list of docx, and get a single new docx back.</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><span style="white-space:pre-wrap;">The extension can also be used to process a </span></span><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 11.0pt;">docx</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;"><span style="white-space:pre-wrap;"> which is embedded as an</span></span><span class="apple-converted-space DefaultParagraphFont " style="color: #000000;font-family: Calibri;font-size: 11.0pt;"> </span><span class="Strong DefaultParagraphFont " style="color: #000000;font-family: Calibri;font-size: 11.0pt;">altChunk</span><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">.  (Without the extension, you have to rely on Word to convert the altChunk to normal content, which means if your docx contains w:altChunk, you have to round trip it through Word, before docx4j can create a PDF or HTML out of it.)</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">To process the w:altChunk elements in a docx, you invoke:</span></p>
  
  <p class="Normal DocDefaults "><span class="HTMLCode DefaultParagraphFont " style="font-family: Consolas;font-size: 8.0pt;">   public</span><span style="font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> </span></span><span class="HTMLCode DefaultParagraphFont " style="font-family: Consolas;font-size: 8.0pt;">WordprocessingMLPackage process(WordprocessingMLPackage srcPackage)</span></p>
  
  <p class="NormalWeb Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 11.0pt;">You pass in a docx containg altChunks, and get a  new docx back which doesn’t.</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Table of Contents</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 4mm;line-height: 140%;"><span style="color: #000000;font-family: Calibri;font-size: 10.0pt;"><span style="white-space:pre-wrap;">The minimal XML docx4j needs to insert into the document for </span></span><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 10.0pt;">Microsoft Word</span><span style="color: #000000;font-family: Calibri;font-size: 10.0pt;"><span style="white-space:pre-wrap;"> to then generate a TOC (including hyperlinks and associated bookmarks), is:</span></span></p><div style="border-color: #FCF9E0; border-style:solid; border-width:1px;background-color: #FCF9E0;space-after: 3mm;line-height: 140%;">
  
  <p class="Normal DocDefaults " style="border-color: #FCF9E0; border-style:solid; border-width:1px;background-color: #FCF9E0;space-after: 3mm;line-height: 140%;"><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;">          &lt;w:p&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />              &lt;w:fldChar w:fldCharType="begin" w:dirty="true"/&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;/w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />              &lt;w:instrText xml:space="preserve"&gt; TOC \o "1-3" \h \z \u &lt;/w:instrText&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;/w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />              &lt;w:fldChar w:fldCharType="end"/&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" />            &lt;/w:r&gt;</span><span style="color: #000000;font-family: Courier New;font-size: 8.5pt;"><br clear="all" /><span style="white-space:pre-wrap;">          &lt;/w:p&gt;  </span></span></p></div>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Trebuchet MS;font-size: 10.0pt;"><br clear="all" /></span></p>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 10.0pt;"><span style="white-space:pre-wrap;">Note the </span></span><span style="font-weight: bold;color: #000000;font-family: Calibri;font-size: 10.0pt;">w:dirty="true"</span><span style="color: #000000;font-family: Calibri;font-size: 10.0pt;">. The actual field code in instrText could be altered to meet your requirements.</span></p>
  
  <p class="Normal DocDefaults "><span style="color: #000000;font-family: Calibri;font-size: 10.0pt;">Note that simply including this is currently not enough for you to get a table of contents in your HTML or PDF output. Currently, you'd need to open/save in Word, and the HTML/PDF output would need to support the result (page numbering will be a problem).</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Text extraction</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">A quick way to extract the text from a docx, is to use </span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">TextUtils‘  </span></span></p>
  
  <p class="Normal DocDefaults "><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static void </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">extractText(Object o, Writer w)</span></p>
  
  <p class="Normal DocDefaults ">which marshals the object it is passed via a SAX ContentHandler, in order to output the text to the Writer.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Text substitution</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Text substitution is easy enough, provided the string you are searching for is represented in a </span><span style="font-weight: bold;font-family: Consolas;"><span style="white-space:pre-wrap;">org.docx4j.wml.Text </span></span>object in the form you expect.</p>
  
  <p class="Normal DocDefaults ">However, that won't necessarily be the case.  The string could be broken across text runs for any of the following reasons:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>part of the word is formatted differently (eg in bold)</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>spelling/grammar</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>editing order (rsid)</p>
  
  <p class="Normal DocDefaults ">This is one reason that using data bound content controls is often a better approach (see next section).</p>
  
  <p class="Normal DocDefaults ">Subject to that, you can do text substitution in a variety of ways, for example:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">traversing the main document part, and looking at the </span><span style="font-weight: bold;font-family: Consolas;"><span style="white-space:pre-wrap;">org.docx4j.wml.Text </span></span>objects</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">marshal to a string, search/replace in that, then unmarshall again </span></p>
  
  <p class="Normal DocDefaults ">docx4j‘s XmlUtils also contains:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">     </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/**</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">     </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* Give a string of wml containing ${key1}, ${key2}, return a suitable</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">     </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">* object.*/</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">Object unmarshallFromTemplate(String wmlTemplateString, </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">        </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">java.util.HashMap&lt;String, String&gt; mappings) </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span></p>
  
  <p class="Normal DocDefaults ">See the UnmarshallFromTemplate example, which operates on a string containing:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-family: Consolas;font-size: 12.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">&lt;w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;w:t&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;"><span style="white-space:pre-wrap;">My favourite colour is </span></span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 10.0pt;">${colour}</span><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">.</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">&lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:t&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   <span style="white-space:pre-wrap;">&lt;w:p </span></span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;w:t&gt;</span><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;"><span style="white-space:pre-wrap;">My favourite ice cream is </span></span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 10.0pt;">${icecream}</span><span style="color: #000000;font-family: Consolas;font-size: 10.0pt;">.</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">&lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:t&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   </span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:r&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">   &lt;</span><span style="color: #0000FF;font-family: Consolas;font-size: 10.0pt;">/</span><span style="color: #800000;font-family: Consolas;font-size: 10.0pt;">w:p&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Text substitution via data bound content controls</span></p>
  
  <p class="Normal DocDefaults ">If you have an XML file containing your own data, WordML has a mechansim for associating entries in that XML with content controls in the document.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Then, when you open the document in Word 2007, Word automatically populates the content controls with the relevant XML data.  (This approach supersedes Word's legacy mail merge fields.  Simple VBA for migrating a document is available at </span><a href="http://blogs.msdn.com/b/microsoft_office_word/archive/2007/03/28/migrating-mail-merge-fields-to-content-controls.aspx"><span class="Hyperlink DefaultParagraphFont " style="font-size: 9.0pt;">http://blogs.msdn.com/b/microsoft_office_word/archive/2007/03/28/migrating-mail-merge-fields-to-content-controls.aspx</span></a><span style="white-space:pre-wrap;"> )</span></p>
  
  <p class="Normal DocDefaults ">This works using XPath.  A data-bound content control looks something like:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">      &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdt</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">        &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdtPr</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">          &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:dataBinding</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 7.5pt;">w:xpath</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">=</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">/root[1]/customer[1]</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 7.5pt;">w:storeItemID</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">=</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">{428C88D8-C0E3-44F0-B5D7-F65D8B9F7EC9}</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;"> /&gt;</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">        &lt;/</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdtPr</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">        &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdtContent</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">          &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:r</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">            &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:rPr</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">              &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:rStyle</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;"> </span></span><span style="color: #FF0000;font-family: Consolas;font-size: 7.5pt;">w:val</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">=</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">PlaceholderText</span><span style="font-family: Consolas;font-size: 7.5pt;">"</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;"> /&gt;</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">            &lt;/</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:rPr</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">            &lt;</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:t</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span><span style="font-family: Consolas;font-size: 7.5pt;">Click here to enter text.</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&lt;/</span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:t</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">          &lt;/</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:r</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">        &lt;/</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdtContent</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;"><span style="white-space:pre-wrap;">      &lt;/</span></span><span style="color: #A31515;font-family: Consolas;font-size: 7.5pt;">w:sdt</span><span style="color: #0000FF;font-family: Consolas;font-size: 7.5pt;">&gt;</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">You XML file is stored as a part in the docx, typically with a path which is something like customXml/item1.xml.   Note: despite the word "customXml" in the path, this functionality is not affected by the 2009 i4i patent saga.</p>
  
  <p class="Normal DocDefaults ">If you have a Word document which contains data-bound content controls and your data, docx4j can fetch the data, and place it in the relevant content controls.</p>
  
  <p class="Normal DocDefaults ">This is useful if you don't want to leave it to Word to do that (for example, you are creating PDFs with docx4j).</p>
  
  <p class="Normal DocDefaults ">Your XML is represented using 2 parts:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">CustomXmlDataStoragePart customXmlDataStoragePart </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   = wordMLPackage.getCustomXmlDataStorageParts().get(itemId);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   <span style="white-space:pre-wrap;">CustomXmlDataStorage customXmlDataStorage </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   = customXmlDataStoragePart.getData();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults ">To apply the bindings:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   </span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">   customXmlDataStoragePart.</span><span style="color: #000000;font-style: italic;font-family: Consolas;font-size: 8.0pt;">applyBindings</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">(wordMLPackage.getMainDocumentPart());</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">See further the CustomXmlBinding sample. </span></p>
  
  <p class="Normal DocDefaults ">If you want to create the same document 5 times, each populated with different data, obviously you'd need to insert new XML data first.</p>
  
  <p class="Heading2 Normal DocDefaults ">Binding extensions for repeats and conditionals</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">A content control is </span><span style="font-style: italic;">conditional</span><span style="white-space:pre-wrap;"> if it (and its contents) are included/excluded from the document based on whether some condition is true or false.</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">A content control is a </span><span style="font-style: italic;">repeat</span><span style="white-space:pre-wrap;"> if it designates that its contents are to be included more than once.  For example, a row of a table for each invoice/order item, or person.</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">docx4j (from 2.5.0) contains a mechanism for processing conditional content controls and repeats.  See </span><a href="http://www.opendope.org/opendope_conventions_v2.3.html"><span class="Hyperlink DefaultParagraphFont ">http://www.opendope.org/opendope_conventions_v2.3.html</span></a><span style="white-space:pre-wrap;"> for an explanation.</span></p><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><div style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;">
  
  <p class="Normal DocDefaults " style="border-left-style: solid;border-left-width: 1px;border-left-color: #000000;border-right-style: solid;border-right-width: 1px;border-right-color: #000000;border-color: #EEECE1; border-style:solid; border-width:1px;background-color: #EEECE1;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">docx4j v2.5.0 implemented v1 of the conventions.  docx4j v2.6.0 implements v2 of the conventions.  You are advised to use a v2 implementation.  See forum post for further details.</span></p></div></div>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">To set up the bindings, you can use the Word Add-In from </span><a href="http://dev.plutext.org/opendope/setup.exe"><span class="Hyperlink DefaultParagraphFont ">http://dev.plutext.org/opendope/setup.exe</span></a><span style="white-space:pre-wrap;"> Please note that you will need to install .NET Framework 4.0 ("full" - the "client profile" is not enough).</span></p>
  
  <p class="Normal DocDefaults ">See also the docx4j sample ContentControlBindingExtensions.</p>
  
  <p class="Heading1 Normal DocDefaults ">SmartArt</p>
  
  <p class="Normal DocDefaults ">docx4j supports reading docx and pptx files which contain SmartArt.</p>
  
  <p class="Normal DocDefaults ">From docx4j 2.7.0, you can also generate SmartArt.</p>
  
  <p class="Normal DocDefaults ">To do this, you need:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">the layout definition for the SmartArt, either in the docx already, or from a glox file </span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>an XML file specifying the list of text items you want to render graphically</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>an XSLT which can convert a transformed version of that XML file into a SmartArt data file.</p>
  
  <p class="Normal DocDefaults ">Docx4j can be used to insert the SmartArt parts into a docx; Word or Powerpoint will then render it when the document is opened.</p>
  
  <p class="Normal DocDefaults ">The code can be found in:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>org.opendope.SmartArt.dataHierarchy</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>org.docx4j.openpackaging.parts.DrawingML, and</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.52in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span>src/glox4j/java</p>
  
  <p class="Heading1 Normal DocDefaults ">Work with the “Flat OPC XML Format”</p>
  
  <p class="Normal DocDefaults ">When you want to look inside a docx document, it's a bit of a pain to have to unzip it to look at the relevant part.</p>
  
  <p class="Normal DocDefaults ">There are 2 ways around this.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">One is </span><a href="http://www.codeplex.com/PackageExplorer"><span style="color: #0000FF;text-decoration: none;">http://www.codeplex.com/PackageExplorer</span></a>, which can unzip the docx, and pretty print a part.</p>
  
  <p class="Normal DocDefaults ">Another is to save the docx as “Word XML document (*.xml)”.  This produces a single XML file, which you can open in an XML editor such as XPontus.</p>
  
  <p class="Normal DocDefaults ">Docx4j can open Flat OPC XML files, and save to them.</p>
  
  <p class="Normal DocDefaults ">To open a Flat OPC XML file:</p>
  
  <p class="Command NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0in;">   <span style="white-space:pre-wrap;">WordprocessingMLPackage wordMLPackage = </span><br clear="all" />      WordprocessingMLPackage.load(new java.io.File(inputfilepath));</p>
  
  <p class="Normal DocDefaults ">To save as Flat OPC XML:</p>
  
  <p class="Command NormalWeb Normal DocDefaults " style="position: relative; margin-left: 0in;">   wordMLPackage.save(new java.io.File(outputfilepath));</p>
  
  <p class="Normal DocDefaults ">In both cases, the Flat OPC code will be used if and only if the file extension is “.xml”.</p>
  
  <p class="Normal DocDefaults ">Converting to/from Flat OPC can be done at the command line, with:</p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Courier New;font-size: 6.5pt;">   java -cp docx4j.jar:log4j-1.2.15.jar org.docx4j.samples.</span><span style="white-space:pre-wrap;"> </span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Courier New;font-size: 6.5pt;">ExportInPackageFormat [input.docx]</span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;"><span style="white-space:pre-wrap;">(and similar for ImportFromPackageFormat). </span></span></p>
  
  <p class="Normal DocDefaults "><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Trebuchet MS;font-size: 8.0pt;">If there are any images in the docx, you'd also need to add to your classpath: xmlgraphics-commons-1.4.jar and commons-logging-1.1.1.jar</span></p>
  
  <p class="Heading1 Normal DocDefaults ">JAXB stuff</p>
  
  <p class="Heading2 Normal DocDefaults ">Cloning</p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">To clone a JAXB object, use one of the following methods in XmlUtils:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">/** Clone this JAXB object, using default JAXBContext. */ </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">&lt;T&gt; T deepCopy(T value) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/** Clone this JAXB object */</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">&lt;T&gt; T deepCopy(T value, JAXBContext jc) </span></span></p>
  
  <p class="Heading2 Normal DocDefaults "><a name="_Ref273527051" /><span>javax.xml.bind.JAXBElement</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">One annoying thing about JAXB, is that an object – say a table – could be represented as </span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.Tbl</span><span style="white-space:pre-wrap;"> (as you would expect).  Or it might be wrapped in a </span><span style="font-weight: bold;color: #000000;font-family: Consolas;font-size: 9.0pt;">javax.xml.bind.JAXBElement</span>, in which case to get the real table, you have to do something like:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">     </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">if </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">( ((JAXBElement)o).getDeclaredType().getName().equals(</span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">"org.docx4j.wml.Tbl"</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">) ) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">          </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.docx4j.wml.Tbl tbl = (org.docx4j.wml.Tbl)((JAXBElement)o).getValue();</span></p>
  
  <p class="Normal DocDefaults " />
  
  <p class="Normal DocDefaults ">XmlUtils.<span style="font-weight: bold;">unwrap</span><span style="white-space:pre-wrap;"> can do this for you.</span></p>
  
  <p class="Normal DocDefaults ">Be careful, though.  If you are intend to copy an unwrapped object into your document (rather than just read it), you'll probably want the object to remain wrapped (JAXB usually wraps them for a reason; without the wrapper, you might find you need an @XmlRootElement annotation in order to be able to marshall ie save your document).</p>
  
  <p class="Heading2 Normal DocDefaults ">@XmlRootElement</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Most commonly used objects have an </span><span style="font-weight: bold;font-family: Consolas;"><span style="white-space:pre-wrap;">@XmlRootElement </span></span><span style="white-space:pre-wrap;">annotation, so they can be marshalled and unmarshalled.  </span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">In some cases, you might find this annotation is missing.  </span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">If you can't add the annotation to the jaxb source code, an alternative is to </span><span style="text-decoration: none;">marshall</span><span style="white-space:pre-wrap;"> it using code which is explicit about the resulting QName.  For example, XmlUtils contains:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">/** Marshal to a W3C document, for object</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">   </span></span><span style="color: #3F5FBF;font-family: Consolas;font-size: 9.0pt;">*  missing an @XmlRootElement annotation.  */</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">  </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">public static </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">org.w3c.dom.Document marshaltoW3CDomDocument(Object o, JAXBContext jc,</span><span style="font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">      </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">String uri, String local, Class declaredType) </span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;">You could use this like so:</p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">CTFootnotes footnotes = </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><br clear="all" /></span><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">        </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">wmlPackage.getMainDocumentPart().getFootnotesPart().getJaxbElement().getValue();</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">CTFtnEdn ftn = footnotes.getFootnote().get(1);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #3F7F5F;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">// No @XmlRootElement on CTFtnEdn, so .. </span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">Document d = XmlUtils.marshaltoW3CDomDocument( ftn,</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #FFFFFF;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">        </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">Context.jc, Namespaces.NS_WORD12, </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 9.0pt;">"footnote"</span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">,  CTFtnEdn.</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 9.0pt;"><span style="white-space:pre-wrap;">class </span></span><span style="color: #000000;font-family: Consolas;font-size: 9.0pt;">);</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;"><span style="white-space:pre-wrap;">Where the problematic object is something you're adding which isn't at the top of the tree, you should add it wrapped in a JAXBElement.  For example, suppose you wanted to add </span></span><span style="color: #000000;font-family: Calibri;">FldChar fldchar.  You'd create it in the ordinary way:</span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 9.0pt;"><span style="white-space:pre-wrap;">    FldChar fldchar = factory.createFldChar();</span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Calibri;">but then what you'd actually add to r.getRunContent() is:</span><span style="color: #000000;font-family: Calibri;">   </span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> JAXBElement( </span></span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> QName(Namespaces.</span></span><span style="color: #0000C0;font-style: italic;font-family: Courier New;font-size: 8.0pt;">NS_WORD12</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;"><span style="white-space:pre-wrap;">, </span></span><span style="color: #2A00FF;font-family: Courier New;font-size: 8.0pt;">"fldChar"</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">), FldChar.</span><span style="font-weight: bold;color: #7F0055;font-family: Courier New;font-size: 8.0pt;">class</span><span style="color: #000000;font-family: Courier New;font-size: 8.0pt;">, fldchar);</span><span class="apple-style-span DefaultParagraphFont " style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> </span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;"><span style="white-space:pre-wrap;">An easier way to do this is to find the appropriate method in the </span><span style="white-space:pre-wrap;">object factory </span>(ie the<span style="white-space:pre-wrap;"> method for creating it wrapped as a JAXBElement</span>).  Use that method signature.<span style="white-space:pre-wrap;">  In this example:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="color: #646464;font-family: Consolas;font-size: 8.0pt;">@XmlElementDecl</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">(namespace = </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">"http://schemas.openxmlformats.org/wordprocessingml/2006/main"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">, name = </span></span><span style="color: #2A00FF;font-family: Consolas;font-size: 8.0pt;">"fldChar"</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">, scope = R.</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">class</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">)</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">    </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">public</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> JAXBElement&lt;FldChar&gt; createRFldChar(FldChar value) {</span></span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">        </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">return</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> </span></span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">new</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;"> JAXBElement&lt;FldChar&gt;(</span></span><span style="color: #0000C0;font-style: italic;font-family: Consolas;font-size: 8.0pt;">_RFldChar_QNAME</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">, FldChar.</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">class</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">, R.</span><span style="font-weight: bold;color: #7F0055;font-family: Consolas;font-size: 8.0pt;">class</span><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;">, value);</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="color: #000000;font-family: Consolas;font-size: 8.0pt;"><span style="white-space:pre-wrap;">    }</span></span></p>
  
  <p class="Normal DocDefaults " style="space-before: 0.07in;space-after: 0.07in;line-height: 100%;" />
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">docx4j-extras</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;"><span style="font-family: Calibri;">src/docx4j-extras contains functionality which is not part of the standard docx4j build:</span></p>
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="font-family: Calibri;">load/save via JCR</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;space-after: 0in;line-height: 100%;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="font-family: Calibri;">PDF conversion via HTML or iText</span></p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">The docx4j forum</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Free community support is available in the docx4j forum, at </span><a href="http://dev.plutext.org/forums/"><span style="color: #0000FF;text-decoration: none;">http://dev.plutext.org/forums/</span></a></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Before posting, please use </span><a href="http://dev.plutext.org/search.html"><span class="Hyperlink DefaultParagraphFont ">http://dev.plutext.org/search.html</span></a><span style="white-space:pre-wrap;"> to check for relevant material.</span></p>
  
  <p class="Normal DocDefaults ">This discussion is generally in English.  If you can volunteer to moderate a forum in another language (for example, French, Chinese, Spanish…), please let us know.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Other Support Options</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">If the free community support available in the docx4j forum does not meet your needs, or you simply want to outsource some coding, you are welcome to purchase programming, consulting and priority support from </span><a href="http://www.plutext.com/m/index.php/docx4j-support.html"><span class="Hyperlink DefaultParagraphFont " style="font-family: Trebuchet MS;font-size: 10.0pt;">http://www.plutext.com/m/index.php/docx4j-support.html</span></a></p>
  
  <p class="Normal DocDefaults ">By purchasing services from Plutext, you support the continued development of docx4j.</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Colophon</span></p>
  
  <p class="Normal DocDefaults ">This document was written in Word 2007, using:</p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">XML pretty printed using </span><a href="http://www.softlion.com/webTools/XmlPrettyPrint/default.aspx"><span style="color: #0000FF;text-decoration: none;">http://www.softlion.com/webTools/XmlPrettyPrint/default.aspx</span></a><span style="white-space:pre-wrap;"> or Package Explorer</span></p>
  
  <p class="ListParagraph Normal DocDefaults " style="position: relative; margin-left: 0.5in;"><span style="position: absolute; left:-0.25in; max-width: 0.25in;font-family: Symbol;"> </span><span style="white-space:pre-wrap;">Java source code formatted using </span><a href="http://www.java2html.de"><span class="Hyperlink DefaultParagraphFont ">http://www.java2html.de</span></a><span style="white-space:pre-wrap;"> (or cut/pasted from Eclipse)</span></p>
  
  <p class="Normal DocDefaults ">The PDF and HTML versions were generated using docx4j (PDF via XSL FO and FOP).</p>
  
  <p class="Heading1 Normal DocDefaults "><span style="font-family: Calibri;">Contacting Plutext</span></p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Unless you have paid for support, general “How do I” type questions should be posted directly to the </span><a href="http://dev.plutext.org/forums/"><span class="Hyperlink DefaultParagraphFont ">docx4j forum</span></a>.  Plutext may post to the forum any questions it receives by email which should have been directed to the forum.</p>
  
  <p class="Normal DocDefaults "><span style="white-space:pre-wrap;">Plutext can be contacted at either </span><a href="mailto:jason@plutext.org"><span class="Hyperlink DefaultParagraphFont ">jason@plutext.org</span></a><span style="white-space:pre-wrap;">, or </span><a href="mailto:jharrop@plutext.com"><span class="Hyperlink DefaultParagraphFont ">jharrop@plutext.com</span></a></p>
  
  <p class="Normal DocDefaults " /></div>
  
  <div class="footnotes">
  
  <p class="Normal DocDefaults " style="space-after: 0in;line-height: 100%;" />
  
  <p class="FootnoteText Normal DocDefaults "><span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fn1"><a href="#fs1">1</a></a></span></span><span style="white-space:pre-wrap;"> </span><a href="../customXml/item1.xml"><span class="Hyperlink DefaultParagraphFont ">http://forums.java.net/jive/thread.jspa?threadID=411</span></a></p>
  
  <p class="FootnoteText Normal DocDefaults "><span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fn2"><a href="#fs2">2</a></a></span></span><span style="white-space:pre-wrap;"> If you get the error 'Access restriction: The type</span><span class="apple-converted-space DefaultParagraphFont "> </span><span class="underline DefaultParagraphFont "><span style="white-space:pre-wrap;">is not accessible due to restriction on required library rt.jar' (perhaps using some combination of Eclipse 3.4 and/or JDK 6 update 10?), you need to go into the Build Path for the project, Libraries tab, select the JRE System Library, and add an access rule, "Accessible, **". </span></span></p>
  
  <p class="FootnoteText Normal DocDefaults "><span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fn3"><a href="#fs3">3</a></a></span></span><span style="white-space:pre-wrap;"> </span><a href="../customXml/item2.xml"><span class="Hyperlink DefaultParagraphFont " style="font-size: 9.0pt;">http://blogs.msdn.com/b/dmahugh/archive/2009/01/16/ecma-376-implementation-notes-for-office-2007-sp2.aspx</span></a></p>
  
  <p class="FootnoteText Normal DocDefaults "><span class="FootnoteReference DefaultParagraphFont "><span style="vertical-align: top; font-size: xx-small"><a name="fn4"><a href="#fs4">4</a></a></span></span><span style="white-space:pre-wrap;"> </span><a href="../customXml/item3.xml"><span class="Hyperlink DefaultParagraphFont " style="font-size: 9.0pt;">http://blogs.msdn.com/b/dmahugh/archive/2010/04/06/office-s-support-for-iso-iec-29500-strict.aspx</span></a></p></div>
  
  
  
  <div class="footer">
  
  <p class="Footer Normal DocDefaults " style="text-align: center;" />
  
  <p class="Footer Normal DocDefaults " /></div>
  
  </body></html>